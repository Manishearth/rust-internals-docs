<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <title>Casting Between Types</title>

    <link rel="stylesheet" type="text/css" href="rust-book.css">

    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    <div id="nav">
                <button id="toggle-nav">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="bar"></span>
                  <span class="bar"></span>
                  <span class="bar"></span>
                </button>
              </div>
<div id='toc' class='mobile-hidden'>
<ul class='chapter'>
<li><a  href='README.html'><b>1.</b> Introduction</a>
</li>
<li><a  href='getting-started.html'><b>2.</b> Getting Started</a>
<ul class='section'>
<li><a  href='installing-rust.html'><b>2.1.</b> Installing Rust</a>
</li>
<li><a  href='hello-world.html'><b>2.2.</b> Hello, world!</a>
</li>
<li><a  href='hello-cargo.html'><b>2.3.</b> Hello, Cargo!</a>
</li>
</ul>
</li>
<li><a  href='learn-rust.html'><b>3.</b> Learn Rust</a>
<ul class='section'>
<li><a  href='guessing-game.html'><b>3.1.</b> Guessing Game</a>
</li>
<li><a  href='dining-philosophers.html'><b>3.2.</b> Dining Philosophers</a>
</li>
<li><a  href='rust-inside-other-languages.html'><b>3.3.</b> Rust Inside Other Languages</a>
</li>
</ul>
</li>
<li><a  href='effective-rust.html'><b>4.</b> Effective Rust</a>
<ul class='section'>
<li><a  href='the-stack-and-the-heap.html'><b>4.1.</b> The Stack and the Heap</a>
</li>
<li><a  href='testing.html'><b>4.2.</b> Testing</a>
</li>
<li><a  href='conditional-compilation.html'><b>4.3.</b> Conditional Compilation</a>
</li>
<li><a  href='documentation.html'><b>4.4.</b> Documentation</a>
</li>
<li><a  href='iterators.html'><b>4.5.</b> Iterators</a>
</li>
<li><a  href='concurrency.html'><b>4.6.</b> Concurrency</a>
</li>
<li><a  href='error-handling.html'><b>4.7.</b> Error Handling</a>
</li>
<li><a  href='choosing-your-guarantees.html'><b>4.8.</b> Choosing your Guarantees</a>
</li>
<li><a  href='ffi.html'><b>4.9.</b> FFI</a>
</li>
<li><a  href='borrow-and-asref.html'><b>4.10.</b> Borrow and AsRef</a>
</li>
<li><a  href='release-channels.html'><b>4.11.</b> Release Channels</a>
</li>
</ul>
</li>
<li><a  href='syntax-and-semantics.html'><b>5.</b> Syntax and Semantics</a>
<ul class='section'>
<li><a  href='variable-bindings.html'><b>5.1.</b> Variable Bindings</a>
</li>
<li><a  href='functions.html'><b>5.2.</b> Functions</a>
</li>
<li><a  href='primitive-types.html'><b>5.3.</b> Primitive Types</a>
</li>
<li><a  href='comments.html'><b>5.4.</b> Comments</a>
</li>
<li><a  href='if.html'><b>5.5.</b> if</a>
</li>
<li><a  href='loops.html'><b>5.6.</b> Loops</a>
</li>
<li><a  href='ownership.html'><b>5.7.</b> Ownership</a>
</li>
<li><a  href='references-and-borrowing.html'><b>5.8.</b> References and Borrowing</a>
</li>
<li><a  href='lifetimes.html'><b>5.9.</b> Lifetimes</a>
</li>
<li><a  href='mutability.html'><b>5.10.</b> Mutability</a>
</li>
<li><a  href='structs.html'><b>5.11.</b> Structs</a>
</li>
<li><a  href='enums.html'><b>5.12.</b> Enums</a>
</li>
<li><a  href='match.html'><b>5.13.</b> Match</a>
</li>
<li><a  href='patterns.html'><b>5.14.</b> Patterns</a>
</li>
<li><a  href='method-syntax.html'><b>5.15.</b> Method Syntax</a>
</li>
<li><a  href='vectors.html'><b>5.16.</b> Vectors</a>
</li>
<li><a  href='strings.html'><b>5.17.</b> Strings</a>
</li>
<li><a  href='generics.html'><b>5.18.</b> Generics</a>
</li>
<li><a  href='traits.html'><b>5.19.</b> Traits</a>
</li>
<li><a  href='drop.html'><b>5.20.</b> Drop</a>
</li>
<li><a  href='if-let.html'><b>5.21.</b> if let</a>
</li>
<li><a  href='trait-objects.html'><b>5.22.</b> Trait Objects</a>
</li>
<li><a  href='closures.html'><b>5.23.</b> Closures</a>
</li>
<li><a  href='ufcs.html'><b>5.24.</b> Universal Function Call Syntax</a>
</li>
<li><a  href='crates-and-modules.html'><b>5.25.</b> Crates and Modules</a>
</li>
<li><a  href='const-and-static.html'><b>5.26.</b> `const` and `static`</a>
</li>
<li><a  href='attributes.html'><b>5.27.</b> Attributes</a>
</li>
<li><a  href='type-aliases.html'><b>5.28.</b> `type` aliases</a>
</li>
<li><a class='active' href='casting-between-types.html'><b>5.29.</b> Casting between types</a>
</li>
<li><a  href='associated-types.html'><b>5.30.</b> Associated Types</a>
</li>
<li><a  href='unsized-types.html'><b>5.31.</b> Unsized Types</a>
</li>
<li><a  href='operators-and-overloading.html'><b>5.32.</b> Operators and Overloading</a>
</li>
<li><a  href='deref-coercions.html'><b>5.33.</b> Deref coercions</a>
</li>
<li><a  href='macros.html'><b>5.34.</b> Macros</a>
</li>
<li><a  href='raw-pointers.html'><b>5.35.</b> Raw Pointers</a>
</li>
<li><a  href='unsafe.html'><b>5.36.</b> `unsafe`</a>
</li>
</ul>
</li>
<li><a  href='nightly-rust.html'><b>6.</b> Nightly Rust</a>
<ul class='section'>
<li><a  href='compiler-plugins.html'><b>6.1.</b> Compiler Plugins</a>
</li>
<li><a  href='inline-assembly.html'><b>6.2.</b> Inline Assembly</a>
</li>
<li><a  href='no-stdlib.html'><b>6.3.</b> No stdlib</a>
</li>
<li><a  href='intrinsics.html'><b>6.4.</b> Intrinsics</a>
</li>
<li><a  href='lang-items.html'><b>6.5.</b> Lang items</a>
</li>
<li><a  href='advanced-linking.html'><b>6.6.</b> Advanced linking</a>
</li>
<li><a  href='benchmark-tests.html'><b>6.7.</b> Benchmark Tests</a>
</li>
<li><a  href='box-syntax-and-patterns.html'><b>6.8.</b> Box Syntax and Patterns</a>
</li>
<li><a  href='slice-patterns.html'><b>6.9.</b> Slice Patterns</a>
</li>
<li><a  href='associated-constants.html'><b>6.10.</b> Associated Constants</a>
</li>
</ul>
</li>
<li><a  href='glossary.html'><b>7.</b> Glossary</a>
</li>
<li><a  href='academic-research.html'><b>8.</b> Academic Research</a>
</li>
</ul>
</div>
<div id='page-wrapper'>
<div id='page'>


    <h1 class="title">Casting Between Types</h1>
    <p>Rust, with its focus on safety, provides two different ways of casting
different types between each other. The first, <code>as</code>, is for safe casts.
In contrast, <code>transmute</code> allows for arbitrary casting, and is one of the
most dangerous features of Rust!</p>

<h1 id="as" class='section-header'><a
                           href="#as"><code>as</code></a></h1>
<p>The <code>as</code> keyword does basic casting:</p>
<span class='rusttest'>fn main() {
    let x: i32 = 5;
    
    let y = x as i64;
    
}</span><pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>x</span>: <span class='ident'>i32</span> <span class='op'>=</span> <span class='number'>5</span>;

<span class='kw'>let</span> <span class='ident'>y</span> <span class='op'>=</span> <span class='ident'>x</span> <span class='kw'>as</span> <span class='ident'>i64</span>;</pre>

<p>It only allows certain kinds of casting, however:</p>
<span class='rusttest'>fn main() {
    let a = [0u8, 0u8, 0u8, 0u8];
    
    let b = a as u32; // four eights makes 32
    
}</span><pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>a</span> <span class='op'>=</span> [<span class='number'>0u8</span>, <span class='number'>0u8</span>, <span class='number'>0u8</span>, <span class='number'>0u8</span>];

<span class='kw'>let</span> <span class='ident'>b</span> <span class='op'>=</span> <span class='ident'>a</span> <span class='kw'>as</span> <span class='ident'>u32</span>; <span class='comment'>// four eights makes 32</span></pre>

<p>This errors with:</p>

<pre><code class="language-text">error: non-scalar cast: `[u8; 4]` as `u32`
let b = a as u32; // four eights makes 32
        ^~~~~~~~
</code></pre>

<p>It’s a ‘non-scalar cast’ because we have multiple values here: the four
elements of the array. These kinds of casts are very dangerous, because they
make assumptions about the way that multiple underlying structures are
implemented. For this, we need something more dangerous.</p>

<h1 id="transmute" class='section-header'><a
                           href="#transmute"><code>transmute</code></a></h1>
<p>The <code>transmute</code> function is provided by a <a href="intrinsics.html">compiler intrinsic</a>, and
what it does is very simple, but very scary. It tells Rust to treat a value of
one type as though it were another type. It does this regardless of the
typechecking system, and just completely trusts you.</p>

<p>In our previous example, we know that an array of four <code>u8</code>s represents a <code>u32</code>
properly, and so we want to do the cast. Using <code>transmute</code> instead of <code>as</code>,
Rust lets us:</p>
<span class='rusttest'>fn main() {
    use std::mem;
    
    unsafe {
        let a = [0u8, 0u8, 0u8, 0u8];
    
        let b = mem::transmute::&lt;[u8; 4], u32&gt;(a);
    }
    
}</span><pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>mem</span>;

<span class='kw'>unsafe</span> {
    <span class='kw'>let</span> <span class='ident'>a</span> <span class='op'>=</span> [<span class='number'>0u8</span>, <span class='number'>0u8</span>, <span class='number'>0u8</span>, <span class='number'>0u8</span>];

    <span class='kw'>let</span> <span class='ident'>b</span> <span class='op'>=</span> <span class='ident'>mem</span>::<span class='ident'>transmute</span>::<span class='op'>&lt;</span>[<span class='ident'>u8</span>; <span class='number'>4</span>], <span class='ident'>u32</span><span class='op'>&gt;</span>(<span class='ident'>a</span>);
}</pre>

<p>We have to wrap the operation in an <code>unsafe</code> block for this to compile
successfully. Technically, only the <code>mem::transmute</code> call itself needs to be in
the block, but it&#39;s nice in this case to enclose everything related, so you
know where to look. In this case, the details about <code>a</code> are also important, and
so they&#39;re in the block. You&#39;ll see code in either style, sometimes the context
is too far away, and wrapping all of the code in <code>unsafe</code> isn&#39;t a great idea.</p>

<p>While <code>transmute</code> does very little checking, it will at least make sure that
the types are the same size. This errors:</p>
<span class='rusttest'>fn main() {
    use std::mem;
    
    unsafe {
        let a = [0u8, 0u8, 0u8, 0u8];
    
        let b = mem::transmute::&lt;[u8; 4], u64&gt;(a);
    }
    
}</span><pre class='rust rust-example-rendered'>
<span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>mem</span>;

<span class='kw'>unsafe</span> {
    <span class='kw'>let</span> <span class='ident'>a</span> <span class='op'>=</span> [<span class='number'>0u8</span>, <span class='number'>0u8</span>, <span class='number'>0u8</span>, <span class='number'>0u8</span>];

    <span class='kw'>let</span> <span class='ident'>b</span> <span class='op'>=</span> <span class='ident'>mem</span>::<span class='ident'>transmute</span>::<span class='op'>&lt;</span>[<span class='ident'>u8</span>; <span class='number'>4</span>], <span class='ident'>u64</span><span class='op'>&gt;</span>(<span class='ident'>a</span>);
}</pre>

<p>with:</p>

<pre><code class="language-text">error: transmute called on types with different sizes: [u8; 4] (32 bits) to u64
(64 bits)
</code></pre>

<p>Other than that, you&#39;re on your own!</p>

    <script type="text/javascript">
        window.playgroundUrl = "https://play.rust-lang.org";
    </script>
    
<script type="text/javascript" src="rust-book.js"></script>
<script type="text/javascript" src="playpen.js"></script>
</div></div>


</body>
</html>